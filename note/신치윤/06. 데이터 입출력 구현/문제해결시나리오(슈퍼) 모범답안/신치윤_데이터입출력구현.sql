-- 테이블 시퀀스 삭제
DROP TABLE CUSTOMER;
DROP TABLE GRADE;
DROP SEQUENCE CUSTOMER_CID_SEQ;

-- 테이블 시퀀스 생성

CREATE TABLE GRADE(
    GNO NUMBER(1) PRIMARY KEY,
    GRADE VARCHAR2(30) NOT NULL,
    LOMOUNT NUMBER(8) NOT NULL,
    HIAMOUNT NUMBER(8) NOT NULL
);

CREATE TABLE CUSTOMER(
    CID NUMBER(5) PRIMARY KEY,
    CTEL VARCHAR2(30) UNIQUE NOT NULL,
    CNAME VARCHAR2(30) NOT NULL,
    CPOINT NUMBER(8) CHECK(CPOINT>=0),
    CAMOUNT NUMBER(8) CHECK(CAMOUNT>=0),
    GNO NUMBER(1) REFERENCES GRADE(GNO)
);

CREATE SEQUENCE CUSTOMER_CID_SEQ MAXVALUE 99999 NOCACHE NOCYCLE;

-- 더미데이터 입력
INSERT INTO GRADE VALUES(1,'BLACK',0,100000);
INSERT INTO GRADE VALUES(2,'NORMAL',100001,500000);
INSERT INTO GRADE VALUES(3,'SILVER',500001,1000000);
INSERT INTO GRADE VALUES(4,'GOLD',1000001,3000000);
INSERT INTO GRADE VALUES(5,'VIP',3000001,10000000);
SELECT * FROM GRADE;

INSERT INTO CUSTOMER VALUES(CUSTOMER_CID_SEQ.NEXTVAL,'010-9999-9999','홍길동',1000,0,1);
INSERT INTO CUSTOMER VALUES(CUSTOMER_CID_SEQ.NEXTVAL,'010-8888-8888','신길동',1000,200000,2);
INSERT INTO CUSTOMER VALUES(CUSTOMER_CID_SEQ.NEXTVAL,'010-7777-7777','마길순',1000,600000,3);

-- JOIN
SELECT CID,CTEL,CNAME,CPOINT,CAMOUNT,GRADE,HIAMOUNT-CAMOUNT "LEVELUP" FROM CUSTOMER C, GRADE G   
    WHERE C.GNO = G.GNO;


