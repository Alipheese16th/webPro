9장 DB설계

1월10일날 실기문제 (데이터입출력 db이용)
쇼핑몰설계 
-회원테이블

-상품테이블

-장바구니테이블
프라이머리키로 해줄만한 컬럼이 없기때문에 시퀀스를 이용한다(사이클 돌려도됨 왜냐면 장바구니는 어차피 계속 없앨 데이터이기때문에)
회원아이디,상품코드, 수량
상품수량은 체크>0

-주문테이블
pk)주문번호 (날짜가 달라지면 시퀀스가 어떻게 초기화될지 궁금함)
회원아이디
주문날짜
배송받을사람
배송지주소(낫널)
배송지전화

-주문내용테이블
주문번호를 포림키로
상품별로 행추가
pk)시퀀스 

주문시
1.주문테이블, 주문내용테이블에 INSERT (서브쿼리)
2.UPDATE 재고수량 수정 (상품테이블)
3.장바구니내용 DELETE

-상품 카테고리별 대분류 중분류 소분류 테이블 등등 추가로 하고싶으면 설정 




10장 뷰, top-n 구문

# 뷰  

가상의 테이블
직접 만들수없고 특정한 테이블을 이용해서야만 만들수있다 서브쿼리이용
CREATE VIEW 라고 할수도있지만
CREATE OR REPLACE VIEW 로 많이쓴다
어차피 물리적인 저장공간이 없기때문에 만약 이미 존재한다면 고쳐쓸수 있기때문

 ### 단순뷰
원래 테이블과 연결되어 있기때문에 데이터수정이 이루어지면 같이 바뀐다 
다만 특정행을 가져오는경우는 WHERE조건에 따라서 
 INSERT는 되지만 검색,수정이나 삭제는 안되는 불상사가 생길수있다

단 뷰 생성시 NOT NULL 필드를 미포함한 경우 INSERT 시
그 필드가 NOT NULL이 되어버리기때문에 INSERT가 불가능해진다

VIEW의 제한조건
-- WITH CHECK OPTION 추가 : 뷰의 조건에 해당되는 데이터만 삽입, 수정, 삭제가 가능
-- WITH READ ONLY 추가 : 읽기 전용 뷰

 ### 복합뷰: 두개이상의 테이블로 구성 OR 가상의 필드를 이용한 경우
복합뷰는 INSERT불가능


 ### Inline-View  
 FROM절의 서브쿼리를 INLINE VIEW라 하며, FROM절에 오는 서브쿼리는 VIEW 작용

즉 SELECT절이나 WHERE절에서 쓰는 서브쿼리는 그냥 서브쿼리고
FROM절에서 쓰는 서브쿼리가 인라인 뷰 

-----------------

데이터입출력구현
LPAD대신 TO_CHAR를 사용해보자



연결연산자( || ) 뒤에 TO_CHAR를 사용하면 ' 내용' 처럼 된다
즉 앞에 스페이스 공간이 하나생기기때문에 TRIM을 사용해야한다
CONCAT을 사용하면 이런문제는 없다

서브쿼리를 컬럼을 추가하든가해서 구조를 변경후 INSERT문에 사용
카트테이블 -> 주문상세 테이블 서브쿼리INSERT가능



