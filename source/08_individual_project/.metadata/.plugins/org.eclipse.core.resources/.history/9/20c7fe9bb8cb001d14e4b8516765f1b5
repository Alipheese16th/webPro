/**
 * 
 */


function test() {
    if ($('#ratingForm').css('display') == 'none') {
        $('#ratingForm').css('display', 'block');
    }
}

	$(document).on('ready', function () {
		
		$('#ratingForm').css('display','none');
		
		$('.write').click(function(){
			var user = "<c:out value='${user}'/>";
			if(!user){
				alert('평점등록은 로그인한 회원만 가능합니다');
			}else{
				var movieId = $('#movieId').val();
				var userId = $('#userId').val();
				
				$.ajax({
					url : '${conPath}/ratingConfirm.do',
					type : 'get',
					data : 'movieId='+movieId+'&userId='+userId,
					dataType : 'html',
					success : function(data){
						$('#result').html(data);
						if($('#result').text().trim() == '이미존재하는평점'){
							alert('이미 평점을 등록하셨습니다');
						}else{
							test();
						}
					}
				});
				
			}
		});
		
		$('#cancel').click(function(){
			if ($('#ratingForm').css('display') == 'block') {
		        $('#ratingForm').css('display', 'none');
		    }
		});
		
		//별점기능 추가
        $('.kv-fa').rating({
            theme: 'krajee-fa',
            filledStar: '<i class="fa fa-star"></i>',
            emptyStar: '<i class="fa fa-star-o"></i>',
            stars:5,
            max:5,
            step:0.5,
            starCaptions:{
            	0: '0',
            	0.5: '1',
            	1: '2',
            	1.5: '3',
            	2: '4',
            	2.5: '5',
            	3: '6',
            	3.5: '7',
            	4: '8',
            	4.5: '9',
            	5: '10'
            }
        });
        $('.rating,.kv-fa').on(
                'change', function () {
                    console.log('Rating selected: ' + $(this).val());
        });
        
        
    });