<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kist.portal.common.home.mapper.homeMapper">

	<!-- 공지사황 -->
	<select id="selectNotiList" parameterType="sqlMap" resultType="sqlMap">
		/* selectNotiList 공지사황 */
		select bbs_doc_no
			  ,substring(crt_dt, 0, 5) || '-' || substring(crt_dt, 5, 2) || '-' || substring(crt_dt, 7, 2) as crt_dt
			  ,bbs_doc_ttl
		 from tb_co_bbs
		where 1=1 
		  and bbs_type_cd = 'NOTI'
		  and del_yn = 'N'
		<if test='biz_cd != null and biz_cd != ""'>
		  and biz_cd = #{biz_cd}
		</if>
		order by crt_dt desc
		<choose>
			<when test='biz_cd != null and biz_cd != ""'>
		 limit 3
			</when>
			<otherwise>
		 limit 5
			</otherwise>
		</choose>
	</select>
	
	<!-- 규제 알람 -->
	<select id="selectRgltAlrmList" parameterType="sqlMap" resultType="sqlMap">
		/* selectRgltAlrmList 규제알람 */
		select rglt_act_alrm_no 
		     , substring(crt_da, 0, 5) || '-' || substring(crt_da, 5, 2) || '-' || substring(crt_da, 7, 2) as crt_da
		     , alrm_ttl 
		  from tb_ch_rglt_act_alrm
		 where del_yn = 'N'
		 order by crt_da desc
 		 limit 3
	</select>
	
	<!-- 원료/소모성자재/물질 산정값 -->
	<select id="selectMtrlCount" parameterType="sqlMap" resultType="sqlMap">
		/* selectMtrlCount 원료/소모성자재/물질 산정값 */
		select to_char(mtrlCount, 'FM999,999,999,999,999') as mtrlCount
		     , to_char(mtrlChkCount, 'FM999,999,999,999,999') as mtrlChkCount
		     , to_char(mroCount, 'FM999,999,999,999,999') as mroCount
		     , to_char(mroChkCount, 'FM999,999,999,999,999') as mroChkCount
		     , to_char(mtrlMroCount, 'FM999,999,999,999,999') as mtrlMroCount
		     , to_char(mtrlMroChkCount, 'FM999,999,999,999,999') as mtrlMroChkCount
		     , case when mtrlCount::numeric > 0 then ((mtrlChkCount::numeric / mtrlCount::numeric) * 100)::Integer else 0::Integer end as mtrlPer
		     , case when mroCount::numeric > 0 then ((mroChkCount::numeric / mroCount::numeric) * 100)::Integer else 0::Integer end as mroPer
		     , case when mtrlMroCount::numeric > 0 then ((mtrlMroChkCount::numeric / mtrlMroCount::numeric) * 100)::Integer else 0::Integer end as mtrlMroPer
		from (
		    select count(mtrl_no) as mtrlCount
		      from tb_co_mtrl tcm 
		    where tcm.rglt_chk_yn = 'Y'
		      and tcm.del_yn = 'N'
		      and tcm.usg_yn = 'Y'
		      and tcm.mtrl_clsf_cd = '1'
		      and exists (
		                    select 1
		                    from tb_co_mtrl_site tcms 
		                    where 1=1
		                      and tcms.del_yn = 'N'
		                      and tcms.mtrl_no = tcm.mtrl_no
		                      <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
		                      and tcms.wkpl_id = #{wkpl_id}
		                      </if>
		                        ) 
		  ) as mtrlCount
		 ,(
		    select count(mtrl_no) as mtrlChkCount
		    from tb_co_mtrl tcm 
		    where tcm.rglt_chk_yn = 'Y'
		      and tcm.del_yn = 'N'
		      and tcm.usg_yn = 'Y'
		      and tcm.mtrl_clsf_cd = '1'
		      and exists (
		        select mtrl_no 
		        from tb_ch_mtrl_rglt tcmrs 
		        where tcm.mtrl_no = tcmrs.mtrl_no
		          and tcmrs.rglt_obj_yn = 'Y' 
		          and tcmrs.usg_yn = 'Y'
		          and tcmrs.del_yn = 'N'
		            )
		      and exists (
		                    select mtrl_no 
		                    from tb_co_mtrl_site tcms 
		                    where 1=1
		                      and tcms.del_yn = 'N'
		                      and tcms.mtrl_no = tcm.mtrl_no 
		                      <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
		                      and tcms.wkpl_id = #{wkpl_id}
		                      </if>
		                 ) 
		  ) as mtrlChkCount
		  ,(
		    select count(mtrl_no) as mroCount
		    from tb_co_mtrl tcm 
		    where tcm.rglt_chk_yn = 'Y'
		      and tcm.mtrl_clsf_cd = '2'
		      and tcm.del_yn = 'N'
		      and tcm.usg_yn = 'Y'
		      and exists (
		                    select mtrl_no 
		                    from tb_co_mtrl_site tcms 
		                    where 1=1
		                      and tcms.mtrl_no = tcm.mtrl_no 
		                      and tcms.del_yn = 'N'
		                      <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
		                      and tcms.wkpl_id = #{wkpl_id}
		                      </if>
		                  ) 
		  ) as mroCount
		 ,(
		    select count(mtrl_no) as mroChkCount
		    from tb_co_mtrl tcm 
		    where tcm.rglt_chk_yn = 'Y'
		      and tcm.mtrl_clsf_cd = '2'
		      and tcm.del_yn = 'N'
		      and tcm.usg_yn = 'Y'
		      and exists (
		                    select mtrl_no 
		                    from tb_ch_mtrl_rglt tcmrs
		                    where tcm.mtrl_no = tcmrs.mtrl_no
		                      and tcmrs.rglt_obj_yn = 'Y' 
		                      and tcmrs.usg_yn = 'Y'
		                      and tcmrs.del_yn = 'N'
		                        )
		      and exists (
		                    select mtrl_no 
		                    from tb_co_mtrl_site tcms 
		                    where 1=1
		                      and tcms.mtrl_no = tcm.mtrl_no 
		                      and tcms.del_yn = 'N'
		                      <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
		                      and tcms.wkpl_id = #{wkpl_id}
		                      </if>
		                        ) 
		  ) as mroChkCount
		 ,(
		   select count(aa.sbst_no) as mtrlMroCount
		     from (select tcms.sbst_no
		             from tb_ch_mtrl_sbst tcms
		             join tb_co_mtrl tcm on tcms.mtrl_no = tcm.mtrl_no 
		            where tcms.del_yn = 'N'
		              and tcm.del_yn = 'N'
		              and tcm.usg_yn = 'Y'
		              and exists (
		                            select 1
		                            from tb_co_mtrl_site tcms 
		                            where 1=1
		                              and tcms.mtrl_no = tcm.mtrl_no 
		                              and tcms.del_yn = 'N'
		                      <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
		                              and tcms.wkpl_id = #{wkpl_id}
		                      </if>
		                        ) 
		            group by tcms.sbst_no
		           ) aa
		  ) as mtrlMroCount
		 ,(
		   select count(aa.sbst_no) as mtrlMroChkCount
		     from (select tcms.sbst_no
		             from tb_ch_mtrl_sbst tcms
		             join tb_ch_mtrl_rglt_sbst tcmrs2 on tcms.mtrl_no = tcmrs2.mtrl_no and tcms.sbst_no = tcmrs2.sbst_no
		             join tb_co_mtrl tcm on tcms.mtrl_no = tcm.mtrl_no 
		            where tcms.del_yn = 'N'
		              and tcm.del_yn = 'N' 
		              and tcm.usg_yn = 'Y'
		              and tcmrs2.usg_yn = 'Y'
		              and tcmrs2.del_yn = 'N'
		              and exists (
		                            select 1
		                            from tb_co_mtrl_site tcms 
		                            where 1=1
		                              and tcms.mtrl_no = tcm.mtrl_no
		                              and tcms.del_yn = 'N'
		                      <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
		                              and tcms.wkpl_id = #{wkpl_id}
		                      </if>
		                        ) 
		            group by tcms.sbst_no
		           ) aa
		  ) as mtrlMroChkCount
	</select>
	
	<!-- 규제물질 대상 순위 -->
	<select id="selectRgltCount" parameterType="sqlMap" resultType="sqlMap">
		/* selectRgltCount 규제물질 대상 순위 */
		select aa.rglt_no
		      ,aa.rglt_nm
		      ,to_char(count(*), 'FM999,999,999,999,999') as rglt_count
		      ,to_char(case when max(cc.tot_cnt) <![CDATA[<=]]> 0 then 0 else round(count(*)*100/max(cc.tot_cnt)::numeric,1) end, 'FM999,999,999,999.0') as rgltper
		  from (
		        select tcr.rglt_no
		              ,tcr.rglt_nm
		          from tb_ch_mtrl_rglt_sbst tcmrs 
		          join tb_ch_rglt tcr on tcmrs.rglt_no = tcr.rglt_no 
		         where tcmrs.usg_yn = 'Y'
		           and tcmrs.del_yn = 'N'
		           and tcr.usg_yn = 'Y'
		           and tcr.del_yn = 'N'
		           and exists (select 1
		                         from tb_co_mtrl_site tcms 
		                        where tcmrs.mtrl_no = tcms.mtrl_no 
		                          <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
		                          and tcms.wkpl_id = #{wkpl_id}
		                          </if>
		                      )
		         group by tcr.rglt_no
		              ,tcr.rglt_nm
		       ) aa
		  join ( select tcr.rglt_no
		               ,tcmrs.sbst_no
		          from tb_ch_mtrl_rglt_sbst tcmrs 
		          join tb_co_mtrl tcm on tcmrs.mtrl_no = tcm.mtrl_no 
		          join tb_ch_rglt tcr on tcmrs.rglt_no = tcr.rglt_no 
		         where tcmrs.usg_yn = 'Y'
		           and tcmrs.del_yn = 'N'
		           and tcr.usg_yn = 'Y'
		           and tcr.del_yn = 'N'
		           and tcm.rglt_chk_yn = 'Y'
		           and tcm.usg_yn = 'Y'
		           and tcm.del_yn = 'N'
		           and exists (select 1
		                         from tb_co_mtrl_site tcms 
		                        where tcmrs.mtrl_no = tcms.mtrl_no 
		                          <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
		                          and tcms.wkpl_id = #{wkpl_id}
		                          </if>
		                      )
		         group by tcr.rglt_no
		              ,tcmrs.sbst_no
		       ) bb on aa.rglt_no = bb.rglt_no
		  join (select count(distinct(tcmrs.sbst_no)) as tot_cnt
		          from tb_ch_mtrl_rglt_sbst tcmrs 
		          join tb_co_mtrl tcm on tcmrs.mtrl_no = tcm.mtrl_no 
		          join tb_ch_rglt tcr on tcmrs.rglt_no = tcr.rglt_no 
		         where tcmrs.usg_yn = 'Y'
		           and tcmrs.del_yn = 'N'
		           and tcr.usg_yn = 'Y'
		           and tcr.del_yn = 'N'
		           and tcm.rglt_chk_yn = 'Y'
		           and tcm.usg_yn = 'Y'
		           and tcm.del_yn = 'N'
		           and exists (select 1
		                         from tb_co_mtrl_site tcms 
		                        where tcmrs.mtrl_no = tcms.mtrl_no 
		                          <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
		                          and tcms.wkpl_id = #{wkpl_id}
		                          </if>
		                      )
		       ) cc on 1=1
		 group by aa.rglt_no
		      ,aa.rglt_nm
		 order by count(*) desc
		 limit 5
	</select>
	
	<!-- 이용문의 담당자 정보 -->
	<select id="selectUseBizList" parameterType="sqlMap" resultType="sqlMap">
		/* selectUseBizList 이용문의 담당자 정보 */
		select fn_get_cd('CO00000006', cnct_1st_cd, 'nm', #{SESS_LANG}) as wkpl_nm
			  ,tcbp.usr_id
		      ,(
		      	select case when #{SESS_LANG} = 'KO' then tcu.usr_ko_nm 
				    when #{SESS_LANG} = 'EN' then tcu.usr_en_nm 
				    else tcu.usr_zh_nm end as usr_nm
		      	from tb_co_user tcu
		      	where tcu.usr_id = tcbp.usr_id
		      ) as usr_nm
		      ,( 
		      	select case when #{SESS_LANG} = 'KO' then tcd.dept_ko_nm 
				    when #{SESS_LANG} = 'EN' then tcd.dept_en_nm 
				    else tcd.dept_en_nm end as usr_nm
		      	from tb_co_dept tcd 
		      	where tcd.dept_cd = (
			      	select tcu.dept_cd 
			      	from tb_co_user tcu
			      	where tcu.usr_id = tcbp.usr_id
			      )
		      ) as dept_nm
		from tb_co_biz_pc tcbp 
		where 1=1
		  and tcbp.biz_pc_grp_cd = 'BG00005'
		  and tcbp.del_yn = 'N'
		  and tcbp.usg_yn = 'Y'
		order by tcbp.sort_seq asc
		limit 3
	</select>
    
    <!-- 화학물질 입고량 -->
	<select id="selectWhList" parameterType="sqlMap" resultType="sqlMap">
		/* selectWhList 화학물질 입고량 */
		select to_char(case when last_month_wh_qty = 0 then 0 else round(last_month_wh_qty/1000000,0) end, 'FM999,999,999,999,999') as lastmonthwhqty
		      ,to_char(case when this_year_wh_qty = 0 then 0 else round(this_year_wh_qty/1000000,0) end, 'FM999,999,999,999,999') as thisyearwhqty
		from (
				select coalesce ((
				        select sum(wh_qty) 
				          from tb_ch_mtrl_wh_mm tcmwm
				          join tb_co_mtrl tcm on tcmwm.mtrl_no = tcm.mtrl_no and tcm.usg_yn = 'Y' and tcm.del_yn = 'N' and tcm.rglt_chk_yn = 'Y' and tcm.mtrl_clsf_cd = '1'
				         where wh_ym = to_char(date_trunc ( 'month', current_timestamp) + '-1 days','YYYYMM')
                   		<if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
                           and tcmwm.wkpl_id = #{wkpl_id}
                   		</if>
				         ),0) as last_month_wh_qty
				      ,coalesce ((
				        select sum(wh_qty) 
				          from tb_ch_mtrl_wh_mm tcmwm
				          join tb_co_mtrl tcm on tcmwm.mtrl_no = tcm.mtrl_no and tcm.usg_yn = 'Y' and tcm.del_yn = 'N' and tcm.rglt_chk_yn = 'Y' and tcm.mtrl_clsf_cd = '1'
				         where wh_yy = to_char(now(),'YYYY')
                   		<if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "ALL"'>
                           and tcmwm.wkpl_id = #{wkpl_id}
                   		</if>
				         ),0) as this_year_wh_qty
		      ) aa
	</select>
    
    <!-- 품목구분별 규제 대상 자재 현황 -->
	<select id="selectRgltSbstList" parameterType="sqlMap" resultType="sqlMap">
		/* selectrgltsbstlist 품목구분별 규제 대상 자재 현황 */
        select coalesce(to_char(max(icmmtrlcnt),'fm999,999,999,999'),'-') as icmmtrlcnt1
              ,coalesce(to_char(max(icsmtrlcnt),'fm999,999,999,999'),'-') as icsmtrlcnt1
              ,coalesce(to_char(max(ihfmtrlcnt),'fm999,999,999,999'),'-') as ihfmtrlcnt1
              ,coalesce(to_char(max(iocmtrlcnt),'fm999,999,999,999'),'-') as iocmtrlcnt1
              ,coalesce(to_char(max(iosmtrlcnt),'fm999,999,999,999'),'-') as iosmtrlcnt1
              ,coalesce(to_char(max(rgtmtrlcnt),'fm999,999,999,999'),'-') as rgtmtrlcnt1
              ,coalesce(to_char(max(mntmtrlcnt),'fm999,999,999,999'),'-') as mntmtrlcnt1
              ,coalesce(to_char(max(icmmtrlcnt2),'fm999,999,999,999'),'-') as icmmtrlcnt2
              ,coalesce(to_char(max(icsmtrlcnt2),'fm999,999,999,999'),'-') as icsmtrlcnt2
              ,coalesce(to_char(max(ihfmtrlcnt2),'fm999,999,999,999'),'-') as ihfmtrlcnt2
              ,coalesce(to_char(max(iocmtrlcnt2),'fm999,999,999,999'),'-') as iocmtrlcnt2
              ,coalesce(to_char(max(iosmtrlcnt2),'fm999,999,999,999'),'-') as iosmtrlcnt2
              ,coalesce(to_char(max(rgtmtrlcnt2),'fm999,999,999,999'),'-') as rgtmtrlcnt2
              ,coalesce(to_char(max(mntmtrlcnt2),'fm999,999,999,999'),'-') as mntmtrlcnt2              
              ,case when max(icmmtrlnm) like '%(%' then substr(max(icmmtrlnm),1,position('(' in max(icmmtrlnm))-1) else max(icmmtrlnm) end as icmmtrlnm
              ,case when max(icsmtrlnm) like '%(%' then substr(max(icsmtrlnm),1,position('(' in max(icsmtrlnm))-1) else max(icsmtrlnm) end as icsmtrlnm
              ,case when max(ihfmtrlnm) like '%(%' then substr(max(ihfmtrlnm),1,position('(' in max(ihfmtrlnm))-1) else max(ihfmtrlnm) end as ihfmtrlnm
              ,case when max(iocmtrlnm) like '%(%' then substr(max(iocmtrlnm),1,position('(' in max(iocmtrlnm))-1) else max(iocmtrlnm) end as iocmtrlnm
              ,case when max(iosmtrlnm) like '%(%' then substr(max(iosmtrlnm),1,position('(' in max(iosmtrlnm))-1) else max(iosmtrlnm) end as iosmtrlnm
              ,case when max(rgtmtrlnm) like '%(%' then substr(max(rgtmtrlnm),1,position('(' in max(rgtmtrlnm))-1) else max(rgtmtrlnm) end as rgtmtrlnm
              ,case when max(mntmtrlnm) like '%(%' then substr(max(mntmtrlnm),1,position('(' in max(mntmtrlnm))-1) else max(mntmtrlnm) end as mntmtrlnm            
        from (
        select case when cd.cd='ICM' then mtrl_cnt end as icmmtrlcnt
              ,case when cd.cd='ICS' then mtrl_cnt end as icsmtrlcnt
              ,case when cd.cd='IHF' then mtrl_cnt end as ihfmtrlcnt
              ,case when cd.cd='IOC' then mtrl_cnt end as iocmtrlcnt
              ,case when cd.cd='IOS' then mtrl_cnt end as iosmtrlcnt
              ,case when cd.cd='RGT' then mtrl_cnt end as rgtmtrlcnt
              ,case when cd.cd='MTN' then mtrl_cnt end as mntmtrlcnt
              ,case when cd.cd='ICM' then mtrl_cnt2 end as icmmtrlcnt2
              ,case when cd.cd='ICS' then mtrl_cnt2 end as icsmtrlcnt2
              ,case when cd.cd='IHF' then mtrl_cnt2 end as ihfmtrlcnt2
              ,case when cd.cd='IOC' then mtrl_cnt2 end as iocmtrlcnt2
              ,case when cd.cd='IOS' then mtrl_cnt2 end as iosmtrlcnt2
              ,case when cd.cd='RGT' then mtrl_cnt2 end as rgtmtrlcnt2
              ,case when cd.cd='MTN' then mtrl_cnt2 end as mntmtrlcnt2
              ,case when cd.cd='ICM' then fn_get_cd('CH00000006',cd.cd,'NM','KO') end as icmmtrlnm
              ,case when cd.cd='ICS' then fn_get_cd('CH00000006',cd.cd,'NM','KO') end as icsmtrlnm
              ,case when cd.cd='IHF' then fn_get_cd('CH00000006',cd.cd,'NM','KO') end as ihfmtrlnm
              ,case when cd.cd='IOC' then fn_get_cd('CH00000006',cd.cd,'NM','KO') end as iocmtrlnm
              ,case when cd.cd='IOS' then fn_get_cd('CH00000006',cd.cd,'NM','KO') end as iosmtrlnm
              ,case when cd.cd='RGT' then fn_get_cd('CH00000006',cd.cd,'NM','KO') end as rgtmtrlnm
              ,case when cd.cd='MTN' then fn_get_cd('CH00000006',cd.cd,'NM','KO') end as mntmtrlnm            
          from tb_co_cd cd
          left outer join 
               (select '1' as rnum
                      ,mt.macl_cd 
                      ,sum(
                            case when tcrcdr.rglt_chk_dt is not null and substring(tcrcdr.rglt_chk_dt,1,6) = to_char(now(),'YYYYMM') then 1
                                 when tcrcdr.rglt_chk_dt is not null and substring(tcrcdr.rglt_chk_dt,1,6) != to_char(now(),'YYYYMM') then 0
                                 when tcrcdr.rglt_chk_dt is null and substring(mt.mtrl_reg_da,1,6) = to_char(now(),'YYYYMM') then 1
                                 when tcrcdr.rglt_chk_dt is null and substring(mt.mtrl_reg_da,1,6) != to_char(now(),'YYYYMM') then 0
                            end
                       ) as mtrl_cnt
                      ,sum(
                            case when tcrcdr.rglt_chk_dt is not null and substring(tcrcdr.rglt_chk_dt,1,4) = to_char(now(),'YYYY') then 1
                                 when tcrcdr.rglt_chk_dt is not null and substring(tcrcdr.rglt_chk_dt,1,4) != to_char(now(),'YYYY') then 0
                                 when tcrcdr.rglt_chk_dt is null and substring(mt.mtrl_reg_da,1,4) = to_char(now(),'YYYY') then 1
                                 when tcrcdr.rglt_chk_dt is null and substring(mt.mtrl_reg_da,1,4) != to_char(now(),'YYYY') then 0
                            end
                       ) as mtrl_cnt2
                  from tb_co_mtrl mt
                  left outer join tb_ch_rglt_chk_mtrl tcrcm on mt.mtrl_no = tcrcm.mtrl_no and chk_req_clsf_cd = '2'
                  left outer join tb_ch_rglt_chk tcrc on tcrcm.rglt_chk_no = tcrc.rglt_chk_no
                  left outer join tb_ch_rglt_chk_doma_rslt tcrcdr on tcrc.rglt_chk_no = tcrcdr.rglt_chk_no and tcrcdr.rglt_chk_doma_cd = 'Z'
		         where mt.rglt_chk_yn = 'Y'
		           and mt.usg_yn = 'Y'
		           and mt.del_yn = 'N'
		           and mt.macl_cd != 'COP'
                   and exists (select 1 
                                 from tb_ch_mtrl_rglt mr 
                                where mr.rglt_obj_yn = 'Y' 
                                  and mt.mtrl_no= mr.mtrl_no)
		           and exists (select 1
		                         from tb_co_mtrl_site tcms 
		                        where tcms.del_yn = 'N'
		                          and mt.mtrl_no = tcms.mtrl_no
		                          <if test='wkpl_id != null and wkpl_id != "" and wkpl_id != "all"'>
		                          and tcms.wkpl_id = #{wkpl_id}
		                          </if>
		                      )
		         group by mt.macl_cd) va on cd.cd=va.macl_cd
		 where cd.cd_grp_no = 'CH00000006'
		   and cd.usg_yn='Y'
		   and cd.del_yn = 'N'
		   and cd.cd != 'COP'
		) aa
	</select>
	
	<!-- 이용 문의 안전/보건담당자 -->
	<select id="selectUseSafeList" parameterType="sqlMap" resultType="sqlMap">
		/* selectUseSafeList 이용 문의 안전/보건담당자 */
		select tcc.cd
		      ,tcm.mlang_cntn as cd_nm
		      ,tcm.mlang_cntn || ' - ' ||
		       case when tcc.cd != 'AC15885870' then
		            (select case when #{SESS_LANG} = 'EN' then tcd.dept_en_nm else tcd.dept_ko_nm end as dept_nm
				       from tb_co_dept tcd 
				      where tcd.dept_cd = tcu.dept_cd 
				     ) || ' / '
				    else ''
			   end ||
		      case when #{SESS_LANG} = 'KO' then tcu.usr_ko_nm 
		           when #{SESS_LANG} = 'EN' then tcu.usr_en_nm 
		           else tcu.usr_zh_nm 
		      end as dept_user_nm
		 from tb_co_cd tcc
		 join tb_co_cd_grp tccg on tccg.cd_grp_no = tcc.cd_grp_no 
		 join tb_co_mlang tcm on tcc.cd_grp_no = tcm.cd_grp_no and tcc.cd = tcm.cd
		 join tb_co_user tcu on tcc.cd = tcu.usr_id 
		where tcc.cd_grp_no = 'CO00000034'
		  and tcm.lang_cd = #{SESS_LANG}
		  and tcc.del_yn = 'N'
		  and tccg.usg_yn = 'Y'
		  and tccg.del_yn = 'N'
		  and tcm.usg_yn = 'Y'
		  and tcm.del_yn = 'N'
	    order by tcc.sort_seq
	</select>
    
</mapper>