<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kist.portal.st.stndinfr.mapper.WkplMgntMapper">

	<!-- 사업장관리 조회 -->
	<select id="selectWkplMgntList" parameterType="sqlMap" resultType="sqlMap">
		/* selectWkplMgntList  */
		select a.wkpl_id 
		      ,fn_get_cd('ST00000002', a.wkpl_id, 'NM', #{SESS_LANG}) as wkpl_nm
		      ,a.cmpy_cd
		      ,fn_get_cd('CO00000009', a.cmpy_cd, 'NM', #{SESS_LANG}) as cmpy_nm
		      ,a.std_ind_cat_cd
		      ,fn_get_cd('ST00000010', a.std_ind_cat_cd, 'NM', #{SESS_LANG}) as std_ind_cat_nm
		      ,a.wkpl_cl_cd
		      ,fn_get_cd('ST00000001', a.wkpl_cl_cd, 'NM', #{SESS_LANG}) as wkpl_cl_nm
		      ,fn_get_mlang('LB00000597', #{SESS_LANG}) as btn_nm
		      ,a.wkpl_addr 
		      ,a.wkpl_tphn
		      ,(select case when #{SESS_LANG} = 'KO' then u.usr_ko_nm 
				            when #{SESS_LANG} = 'EN' then u.usr_en_nm 
				            else u.usr_zh_nm 
				       end as usr_nm
			      from tb_co_user u
			     where u.usr_id = a.sfhe_mgnt_rspn_usr_id
			   ) as sfhe_mgnt_rspn_usr_nm
		      ,a.clgt_rspn_usr_id
		      ,(select case when #{SESS_LANG} = 'KO' then u.usr_ko_nm 
				            when #{SESS_LANG} = 'EN' then u.usr_en_nm 
				            else u.usr_zh_nm 
				       end as usr_nm
			      from tb_co_user u
			     where u.usr_id = a.clgt_rspn_usr_id
			   ) as clgt_rspn_usr_nm
		      ,a.wkpl_work_prsn_cnt
		      ,(select sum(b.sbcn_prsn_cnt) as sbcn_prsn_cnt
		          from tb_sh_wkpl_rsdt_sbcn b
		         where b.wkpl_id = a.wkpl_id
		         group by b.wkpl_id
		       ) as sbcn_prsn_cnt
		      ,(select c.apal_atht_grd_cd || ' (' || to_char(to_timestamp(c.apal_atht_dt, 'YYYYMMDDHH24MISS'), 'YYYY-MM-DD') || ')' as apal_atht_grd_cd
		          from tb_sh_wkpl_apal_atht c
		         where c.wkpl_id = a.wkpl_id 
		           and c.apal_atht_cl_cd = 'A01'
		       ) as apal_atht_grd_cd
		      ,(select to_char(to_timestamp(c.apal_re_atht_dt, 'YYYYMMDDHH24MISS'), 'YYYY-MM-DD') as apal_re_atht_dt
		          from tb_sh_wkpl_apal_atht c
		         where c.wkpl_id = a.wkpl_id
		           and c.apal_atht_cl_cd = 'A02'
		       ) as apal_re_atht_dt
		      ,(select u.dept_cd
			      from tb_co_user u
			     where u.usr_id = a.upt_usr_id
			   ) as dept_cd
			  ,a.crt_usr_id
		  from tb_sh_wkpl a
              ,tb_co_cd b
		 where 1 = 1
           and b.cd_grp_no = 'ST00000002'
           and a.wkpl_id = b.cd
		 <if test='cmpy_cd != null and cmpy_cd != ""'>
		   and a.cmpy_cd = #{cmpy_cd}
		 </if>
		 <if test='wkpl_id != null and wkpl_id != ""'>
		   and a.wkpl_id like concat('%', rtrim(ltrim(#{wkpl_id})), '%')
		 </if>
		 <if test='wkpl_nm != null and wkpl_nm != ""'>
		   and exists (select 1 
		    			 from tb_co_mlang m
		    		    where m.cd_grp_no = 'ST00000002'
		    			  and m.usg_yn = 'Y'
   						  and m.del_yn = 'N'
   						  and m.cd = a.wkpl_id 
   						  and m.mlang_cntn like concat('%', rtrim(ltrim(#{wkpl_nm})), '%') 
		    		  )
		 </if>
		   and a.del_yn = 'N'
		 order by b.sort_seq
	</select>
	
	<!-- 사업장 관리 상세 조회 -->
	<select id="selectWkplMgntDtl" parameterType="sqlMap" resultType="sqlMap">
		/* selectWkplMgntDtl */
		select a.wkpl_id
		      ,a.wkpl_id as org_wkpl_id
		      ,'ST00000002' as cd_grp_no
		      ,fn_get_cd('ST00000002', a.wkpl_id, 'NM', #{SESS_LANG}) as wkpl_nm
		      ,a.cmpy_cd
		      ,fn_get_cd('CO00000009', a.cmpy_cd, 'NM', #{SESS_LANG}) as cmpy_nm
		      ,a.std_ind_cat_cd
		      ,fn_get_cd('ST00000010', a.std_ind_cat_cd, 'NM', #{SESS_LANG}) as std_ind_cat_nm
		      ,a.wkpl_cl_cd
		      ,fn_get_cd('ST00000001', a.wkpl_cl_cd, 'NM', #{SESS_LANG}) as wkpl_cl_nm
		      ,a.wkpl_addr
		      ,a.wkpl_tphn
		      ,a.cntr_cd
		      ,a.lang_cd
		      ,a.curr_cd
		      ,a.sfhe_mgnt_rspn_usr_id
		      ,(select case when #{SESS_LANG} = 'KO' then u.usr_ko_nm 
				            when #{SESS_LANG} = 'EN' then u.usr_en_nm 
				            else u.usr_zh_nm 
				       end as usr_nm
			      from tb_co_user u
			     where u.usr_id = a.sfhe_mgnt_rspn_usr_id
			   ) as sfhe_mgnt_rspn_usr_nm
		      ,a.clgt_rspn_usr_id
		      ,(select case when #{SESS_LANG} = 'KO' then u.usr_ko_nm 
				            when #{SESS_LANG} = 'EN' then u.usr_en_nm 
				            else u.usr_zh_nm 
				       end as usr_nm
			      from tb_co_user u
			     where u.usr_id = a.clgt_rspn_usr_id
			   ) as clgt_rspn_usr_nm
		      ,a.wkpl_work_prsn_cnt
		      ,a.yrly_mfg_qty
		      ,a.bspr_no
		      ,a.rprv_nm
		      ,a.inai_wkpl_mgnt_no
		      ,a.plnt_mgnt_no
		      ,a.wkpl_mgnt_no
		      ,a.wkpl_ogch_atfl_no
		      ,a.wkpl_atfl_no
		      ,(select case when sum(b.sbcn_prsn_cnt) > 0 then sum(b.sbcn_prsn_cnt)
		                    else '0'
		               end as sbcn_prsn_cnt
		          from tb_sh_wkpl_rsdt_sbcn b
		         where b.wkpl_id = a.wkpl_id
		       ) as sbcn_prsn_sum_cnt
		      ,(select count(1) as sbcn_prsn_cnt
		          from tb_sh_wkpl_rsdt_sbcn b
		         where b.wkpl_id = a.wkpl_id 
		       ) as sbcn_sum_cnt
		      ,a.usg_yn
		      ,a.del_yn
		      ,a.crt_usr_id
		      ,a.crt_dt
		      ,a.upt_usr_id
		      ,a.upt_dt
		      ,a.wkpl_main_bsns_cd
		      ,fn_get_cd('ST00000015', a.wkpl_main_bsns_cd, 'NM', #{SESS_LANG}) as wkpl_main_bsns_nm
		      ,a.weat_rgn_cd
		      ,fn_get_cd('ST00000023', a.weat_rgn_cd, 'NM', #{SESS_LANG}) as weat_rgn_nm
		      ,(select case when #{SESS_LANG} = 'KO' then u.usr_ko_nm 
				            when #{SESS_LANG} = 'EN' then u.usr_en_nm 
				            else u.usr_zh_nm 
				       end as usr_nm
			      from tb_co_user u
			     where u.usr_id = a.upt_usr_id
			   ) as lsch_nm
		      ,coalesce(a.wkpl_img_atfl_no, 0) as wkpl_img_atfl_no
		  from tb_sh_wkpl a
		 where a.wkpl_id = #{wkpl_id}
	</select>
	
	<!-- 사업장 선임정보 조회 -->
	<select id="selectWkplMgntElcList" parameterType="sqlMap" resultType="sqlMap">
		/* selectWkplMgntElcList */
		select a.wkpl_id
			  ,a.elc_reg_sn
			  ,a.elc_cl_cd
			  ,fn_get_cd('ST00000004', a.elc_cl_cd, 'NM', #{SESS_LANG}) as elc_cl_nm
			  ,a.elc_cl_oth_txt
			  ,a.elc_dtl_cl_cd
			  ,fn_get_cd('SH00000088', a.elc_dtl_cl_cd, 'NM', #{SESS_LANG}) as elc_dtl_cl_nm
			  ,a.ag_yn
			  ,a.bsns_agen_orga_nm
			  ,a.bsns_agen_cont_rnew_dt
			  ,a.elc_rspn_usr_id
			  ,(case when a.ag_yn = 'Y'
			  		 then a.elc_pric_nm
			  		 else (case when #{SESS_LANG} = 'KO'
			  				    then b.usr_ko_nm 
							    when #{SESS_LANG} = 'EN'
							    then b.usr_en_nm 
							    else b.usr_zh_nm 
						    end)
				 end) as elc_pric_nm
			  ,(case when a.ag_yn = 'Y'
			  		 then a.elc_pric_dept_nm
			  		 else (case when #{SESS_LANG} = 'KO'
			  				    then b.dept_ko_nm 
							    else b.dept_en_nm 
						    end)
				 end) as elc_pric_dept_nm
			  ,(case when a.ag_yn = 'Y'
			  		 then a.elc_pric_pstn_nm
			  		 else (case when a.elc_pric_pstn_nm = '-'
					  	   then a.elc_pric_pstn_nm
					  	   else (case when 'KO' = 'KO'
					  				    then b.jkw_ko_nm 
										else b.jkw_en_nm 
						          end)
						   end)	
				 end) as elc_pric_pstn_nm
			  ,a.ctsv_yrs
			  ,a.ctsv_mths
			  ,a.wkpl_elc_dt
			  ,a.elc_crr_yrs
			  ,a.elc_crr_mths
			  ,(case when a.ag_yn = 'Y'
			  		 then a.elc_pric_tel_no
			  		 else b.usr_cpho_no
				 end) as elc_pric_tel_no
			  ,(case when a.ag_yn = 'Y'
			  		 then a.elc_pric_email
			  		 else b.usr_email
				 end) as elc_pric_email
			  ,a.crtf_nm
			  ,a.mand_tlgl_trn_yn
			  ,a.fst_trn_fcst_dt
			  ,a.rglr_trn_fcst_dt
			  ,a.elc_trn_cyc_cd
			  ,fn_get_cd('SH00000089', a.elc_trn_cyc_cd, 'NM', #{SESS_LANG}) as elc_trn_cyc_nm
			  ,a.trn_expr_dt
			  ,a.trn_fcst_cert_reg_yn
			  ,fn_get_cd('SH00000090', a.trn_fcst_cert_reg_yn, 'NM', #{SESS_LANG}) as trn_fcst_cert_reg_yn_nm
			  ,a.elc_infr_atfl_no
			  ,(select count(1) as cnt
				  from tb_co_atfl e
				 where e.atfl_no = a.elc_infr_atfl_no
			   ) as elc_atfl_cnt
			  ,a.crt_usr_id
			  ,a.crt_dt
			  ,a.upt_usr_id
			  ,a.upt_dt
			  ,b.del_yn as retire_yn
		  from tb_sh_wkpl_elc a
		  left outer join (select aa.usr_id
		  						 ,aa.usr_ko_nm
		  						 ,aa.usr_en_nm
		  						 ,aa.usr_zh_nm
		  						 ,aa.jkw_ko_nm
		  						 ,aa.jkw_en_nm
		  						 ,aa.usr_cpho_no
		  						 ,aa.usr_email
		  						 ,aa.del_yn
		  						 ,bb.dept_ko_nm
		  						 ,bb.dept_en_nm
		  					 from tb_co_user aa
		  					inner join tb_co_dept bb
		  					   on aa.dept_cd = bb.dept_cd
		  				  ) b
		    on a.elc_rspn_usr_id = b.usr_id
		 where a.wkpl_id = #{wkpl_id}
	</select>
	
	<!-- 사업장 선임현황 목록 조회 -->
	<select id="selectWkplElcMgntDtl" parameterType="sqlMap" resultType="sqlMap">
		/* selectWkplElcMgntDtl */
		select a.wkpl_id
		      ,fn_get_cd('ST00000002', a.wkpl_id, 'NM', #{SESS_LANG}) as wkpl_nm
		      ,b.cmpy_cd
		      ,fn_get_cd('CO00000009', b.cmpy_cd, 'NM', #{SESS_LANG}) as cmpy_nm
			  ,a.elc_reg_sn
			  ,a.elc_cl_cd
			  ,fn_get_cd('ST00000004', a.elc_cl_cd, 'NM', #{SESS_LANG}) as elc_cl_nm
			  ,a.elc_cl_oth_txt
			  ,a.elc_dtl_cl_cd
			  ,fn_get_cd('SH00000088', a.elc_dtl_cl_cd, 'NM', #{SESS_LANG}) as elc_dtl_cl_nm
			  ,a.ag_yn
			  ,a.bsns_agen_orga_nm
			  ,a.bsns_agen_cont_rnew_dt
			  ,a.elc_rspn_usr_id
			  ,case when a.ag_yn = 'Y'
			  		then a.elc_pric_nm
			  		else (select case when #{SESS_LANG} = 'KO'
			  						  then u.usr_ko_nm 
									  when #{SESS_LANG} = 'EN'
									  then u.usr_en_nm 
									  else u.usr_zh_nm 
								  end as usr_nm
							from tb_co_user u
						   where u.usr_id = a.elc_rspn_usr_id
						 ) end 
			   as elc_pric_nm
			  ,case when a.ag_yn = 'Y'
			  		then a.elc_pric_dept_nm
			  		else (select case when #{SESS_LANG} = 'KO'
			  						  then d.dept_ko_nm 
									  else d.dept_en_nm 
								  end as dept_nm
						    from tb_co_user u
								,tb_co_dept d
						   where u.usr_id = a.elc_rspn_usr_id
							 and u.dept_cd = d.dept_cd
						 ) end 
			   as elc_pric_dept_nm
			  ,case when a.ag_yn = 'Y'
			  		then a.elc_pric_pstn_nm
			  		else case when a.elc_pric_pstn_nm = '-'
					  	      then a.elc_pric_pstn_nm
					  	      else (select case when 'KO' = 'KO'
					  				            then u.jkw_ko_nm 
										        else u.jkw_en_nm 
						                    end
								      from tb_co_user u
								     where u.usr_id = a.elc_rspn_usr_id
		                  			)
                		  end
                end
               as elc_pric_pstn_nm
			  ,a.ctsv_yrs
			  ,a.ctsv_mths
			  ,a.wkpl_elc_dt
			  ,a.elc_crr_yrs
			  ,a.elc_crr_mths
			  ,case when a.ag_yn = 'Y'
			  		then a.elc_pric_tel_no
			  		else (select u.usr_cpho_no
						    from tb_co_user u
						   where u.usr_id = a.elc_rspn_usr_id
						 ) end
			   as elc_pric_tel_no
			  ,case when a.ag_yn = 'Y'
			  		then a.elc_pric_email
			  		else (select u.usr_email
						    from tb_co_user u
						   where u.usr_id = a.elc_rspn_usr_id
						 ) end 
			   as elc_pric_email
			  ,a.crtf_nm
			  ,a.mand_tlgl_trn_yn
			  ,a.fst_trn_fcst_dt
			  ,a.rglr_trn_fcst_dt
			  ,a.elc_trn_cyc_cd
			  ,fn_get_cd('SH00000089', a.elc_trn_cyc_cd, 'NM', #{SESS_LANG}) as elc_trn_cyc_nm
			  ,a.trn_expr_dt
			  ,a.trn_fcst_cert_reg_yn
			  ,fn_get_cd('SH00000090', a.trn_fcst_cert_reg_yn, 'NM', #{SESS_LANG}) as trn_fcst_cert_reg_yn_nm
			  ,a.elc_infr_atfl_no
			  ,(select count(1) as cnt
				  from tb_co_atfl e
				 where e.atfl_no = a.elc_infr_atfl_no
			   ) as elc_atfl_cnt
			  ,a.crt_usr_id
			  ,a.crt_dt
			  ,a.upt_usr_id
			  ,a.upt_dt
			  ,a.aprv_prst_cd
			  ,a.aprv_no
			  ,fn_get_dept(c.dept_cd,'DD','KO') as dept_head_id
		  from tb_sh_wkpl_elc a
		 inner join tb_sh_wkpl b
		    on a.wkpl_id = b.wkpl_id
		  left outer join tb_co_user c
		    on a.elc_rspn_usr_id = c.usr_id 
		 where b.cmpy_cd = #{cmpy_cd}
		 <if test='wkpl_id != null and wkpl_id != ""'>
		   and a.wkpl_id = #{wkpl_id}
		 </if>
		 <if test='elc_cl_cd != null and elc_cl_cd != ""'>
		   and a.elc_cl_cd = #{elc_cl_cd}
		 </if>
		 <if test='ag_yn != null and ag_yn != ""'>
		   and a.ag_yn = #{ag_yn}
		 </if>
		 <if test='elc_pric_nm != null and elc_pric_nm != ""'>
		   and a.elc_pric_nm like concat('%', rtrim(ltrim(#{elc_pric_nm})), '%')
		 </if>
		 <if test='mand_tlgl_trn_yn != null and mand_tlgl_trn_yn != ""'>
		   and a.mand_tlgl_trn_yn = #{mand_tlgl_trn_yn}
		 </if>
		 <if test='sDate != null and sDate != "" and eDate != null and eDate != ""'>
		   and (a.fst_trn_fcst_dt between replace(#{sDate},'-','') and replace(#{eDate},'-','')
		   		or a.rglr_trn_fcst_dt between replace(#{sDate},'-','') and replace(#{eDate},'-','')
		   		or a.fst_trn_fcst_dt is null
		   		or a.fst_trn_fcst_dt = ''
		   		or a.rglr_trn_fcst_dt is null
		   		or a.rglr_trn_fcst_dt = '')
		 </if>
		 <if test='trn_fcst_cert_reg_yn != null and trn_fcst_cert_reg_yn != ""'>
		   and a.trn_fcst_cert_reg_yn = #{trn_fcst_cert_reg_yn}
		 </if>
	</select>
	
	<!-- 사업장 선임정보 이력 조회 -->
	<select id="selectWkplTrnList" parameterType="sqlMap" resultType="sqlMap">
		/* selectWkplTrnList */
		select a.elc_rspn_usr_id
			  ,fn_get_user(a.elc_rspn_usr_id,'NM',#{SESS_LANG}) as elc_rspn_usr_nm
			  ,a.elc_cl_cd
			  ,a.trn_fcst_sn
			  ,substring(a.trn_fcst_dt, 0, 5) || '-' || substring(a.trn_fcst_dt, 5, 2) || '-' || substring(a.trn_fcst_dt, 7, 2) as trn_fcst_dt
		      ,(select atfl_no || '-' || atfl_seq
		          from tb_co_atfl z
		         where z.atfl_no = a.trn_fcst_atfl_no) as trn_fcst_atfl_no
		      ,(select atfl_nm
		          from tb_co_atfl z
		         where z.atfl_no = a.trn_fcst_atfl_no) as trn_fcst_atfl_nm
		      ,a.crt_usr_id
		      ,a.crt_dt
		      ,a.upt_usr_id
		      ,a.upt_dt
		  from tb_sh_elc_trn_fcst_hist a
		 where a.elc_rspn_usr_id = #{elc_rspn_usr_id}
	 	   and a.elc_cl_cd = #{elc_cl_cd}
	</select>
	
	<!-- 사업장 협력사 정보 조회 -->
	<select id="selectWkplMgntSbcnList" parameterType="sqlMap" resultType="sqlMap">
		/* selectWkplMgntSbcnList */
		select a.wkpl_id
			  ,a.sbcn_reg_sn
			  ,a.sbcn_nm
			  ,a.bspr_no
			  ,a.inai_wkpl_mgnt_no
			  ,a.sbcn_main_bsns_cd
			  ,fn_get_cd('ST00000005', a.sbcn_main_bsns_cd, 'NM', #{SESS_LANG}) as sbcn_main_bsns_nm
			  ,a.sbcn_prsn_cnt
			  ,a.sbcn_fld_pric_nm
			  ,a.sbcn_rprv_nm
			  ,a.mgnt_pric_nm
			  ,a.sft_pric_nm
			  ,a.hyg_pric_nm
			  ,a.sbcn_rprs_emad
			  ,a.wkpl_note_txt
			  ,a.crt_usr_id
			  ,a.crt_dt
			  ,fn_get_user(a.upt_usr_id , 'NM', #{SESS_LANG}) as upt_usr_id
			  ,to_char(a.upt_dt, 'YYYY-MM-DD') as upt_dt
		  from tb_sh_wkpl_rsdt_sbcn a
		 where a.wkpl_id = #{wkpl_id}
	</select>
	
	<!-- 사업장 평가 정보 조회 -->
	<select id="selectWkplMgntApalList" parameterType="sqlMap" resultType="sqlMap">
		/* selectWkplMgntApalList */
		select a.wkpl_id
			  ,a.apal_atht_reg_sn
			  ,a.apal_atht_cl_cd
			  ,a.apal_atht_cl_cd as org_apal_atht_cl_cd
			  ,fn_get_cd('ST00000003', a.apal_atht_cl_cd, 'NM', #{SESS_LANG}) as apal_atht_cl_nm
			  ,to_char(to_timestamp(a.apal_atht_dt, 'YYYYMMDDHH24MISS'), 'YYYY-MM-DD') as apal_atht_dt
			  ,a.apal_atht_grd_cd
			  ,fn_get_cd('ST00000003', a.apal_atht_grd_cd, 'NM', #{SESS_LANG}) as apal_atht_grd_nm
			  ,to_char(to_timestamp(a.apal_re_atht_dt, 'YYYYMMDDHH24MISS'), 'YYYY-MM-DD') as apal_re_atht_dt
			  ,a.apal_atht_atfl_no
			  ,(select count(1) as cnt
				  from tb_co_atfl e
				 where e.atfl_no = a.apal_atht_atfl_no
			   ) as apal_atfl_cnt
			  ,a.crt_usr_id
			  ,a.crt_dt
			  ,a.upt_usr_id
			  ,a.upt_dt
		  from tb_sh_wkpl_apal_atht a
		 where a.wkpl_id = #{wkpl_id}
	</select>
	
	<!-- 사업장 위치 정보 조회 -->
	<select id="selectWkplMgntRgnList" parameterType="sqlMap" resultType="sqlMap">
		/* selectWkplMgntRgnList */
		select a.wkpl_id
			  ,a.wkpl_loc_id
			  ,a.wkpl_loc_xcrd
			  ,a.wkpl_loc_ycrd
			  ,b.wkpl_loc_nm
		  from tb_sh_wkpl_sts_loc a
		  join tb_sh_wkpl_loc b on a.wkpl_loc_id = b.wkpl_loc_id
		 where a.wkpl_id = #{wkpl_id}
	</select>
	
	<!-- 사업장 코드 키 중복체크 -->
	<select id="selectWkplMgntKeyPass" parameterType="sqlMap" resultType="string">
		/* selectWkplMgntKeyPass */
		select case when count(1) > 0 then 'N'
		            else 'Y'
		       end as pass_yn
		  from tb_sh_wkpl 
		 where wkpl_id = #{wkpl_id}
	</select>
	
	<!-- 사업장 코드 키 채번 -->
	<select id="selectWkplMgntKey" parameterType="sqlMap" resultType="sqlMap">
		/* selectWkplMgntKey */
		select 'S' || LPAD((coalesce(max(substring(cd,2) ::integer),0) + 1)::text, 3, '0') as key
		      ,coalesce(max(sort_seq),0) + 1 as sort_seq 
		  from tb_co_cd
		 where cd_grp_no = 'ST00000002'
	</select>
	
	<!-- 사업장 등록 -->
	<insert id="insertWkplMgnt" parameterType="sqlMap">
        /* insertWkplMgnt */
        with upsert as (
		update tb_sh_wkpl
		   set cmpy_cd    					= #{cmpy_cd}
		      ,std_ind_cat_cd    			= #{std_ind_cat_cd}
		      ,wkpl_cl_cd            	= #{wkpl_cl_cd}
		      ,wkpl_addr					= #{wkpl_addr}
		      ,wkpl_tphn					= #{wkpl_tphn}
		      ,cntr_cd					= #{cntr_cd}
		      ,lang_cd					= #{lang_cd}
		      ,curr_cd					= #{curr_cd}
		      ,sfhe_mgnt_rspn_usr_id		= #{sfhe_mgnt_rspn_usr_id}
		      ,clgt_rspn_usr_id				= #{clgt_rspn_usr_id}
		      ,wkpl_work_prsn_cnt			= case when #{wkpl_work_prsn_cnt}::text  = '' then null 
									   			   else #{wkpl_work_prsn_cnt}::numeric 
							    	 		   end
		      ,yrly_mfg_qty					= case when #{yrly_mfg_qty}::text  = '' then null 
									   			   else #{yrly_mfg_qty}::numeric 
							    	 		   end
		      ,bspr_no						= #{bspr_no}
		      ,rprv_nm						= #{rprv_nm}
		      ,inai_wkpl_mgnt_no			= #{inai_wkpl_mgnt_no}
		      ,plnt_mgnt_no					= #{plnt_mgnt_no}
		      ,wkpl_mgnt_no					= #{wkpl_mgnt_no}
		      ,wkpl_main_bsns_cd        = #{wkpl_main_bsns_cd}
		      ,weat_rgn_cd					= #{weat_rgn_cd}
		      ,wkpl_ogch_atfl_no	= case when #{wkpl_ogch_atfl_no}::text  = '' then null 
								   			   else #{wkpl_ogch_atfl_no}::INTEGER 
						    	 		   end
		      ,wkpl_atfl_no		= case when #{wkpl_atfl_no}::text  = '' then null 
								   			   else #{wkpl_atfl_no}::INTEGER 
						    	 		   end
			  ,usg_yn                       = #{usg_yn}
		      ,upt_usr_id       				= #{username}
		      ,upt_dt            			= current_timestamp
			  ,wkpl_img_atfl_no             = #{wkpl_img_atfl_no}
		 where wkpl_id = #{wkpl_id} RETURNING *
		)
        insert into tb_sh_wkpl (
        	   wkpl_id
			  ,cmpy_cd
			  ,std_ind_cat_cd
			  ,wkpl_cl_cd
			  ,wkpl_addr
			  ,wkpl_tphn
			  ,cntr_cd
			  ,lang_cd
			  ,curr_cd
			  ,sfhe_mgnt_rspn_usr_id
			  ,clgt_rspn_usr_id
			  ,wkpl_work_prsn_cnt
			  ,yrly_mfg_qty
			  ,bspr_no
			  ,rprv_nm
			  ,inai_wkpl_mgnt_no
			  ,plnt_mgnt_no
			  ,wkpl_mgnt_no
			  ,wkpl_ogch_atfl_no
			  ,wkpl_atfl_no
			  ,wkpl_main_bsns_cd
			  ,weat_rgn_cd
			  ,usg_yn
			  ,del_yn
			  ,crt_usr_id
			  ,crt_dt
			  ,upt_usr_id
			  ,upt_dt
			  ,wkpl_img_atfl_no
		)
		select #{wkpl_id}
	 		  ,#{cmpy_cd}
	 		  ,#{std_ind_cat_cd}
			  ,#{wkpl_cl_cd}
			  ,#{wkpl_addr}
			  ,#{wkpl_tphn}
			  ,#{cntr_cd}
			  ,#{lang_cd}
			  ,#{curr_cd}
			  ,#{sfhe_mgnt_rspn_usr_id}
			  ,#{clgt_rspn_usr_id}
			  ,case when #{wkpl_work_prsn_cnt}::text  = '' then null 
	   			    else #{wkpl_work_prsn_cnt}::numeric 
   	 		   end
			  ,case when #{yrly_mfg_qty}::text  = '' then null 
	   			    else #{yrly_mfg_qty}::numeric 
   	 		   end
			  ,#{bspr_no}
			  ,#{rprv_nm}
			  ,#{inai_wkpl_mgnt_no}
			  ,#{plnt_mgnt_no}
			  ,#{wkpl_mgnt_no}
			  ,case when #{wkpl_ogch_atfl_no}::text  = '' then null 
	   			    else #{wkpl_ogch_atfl_no}::INTEGER 
   	 		   end
			  ,case when #{wkpl_atfl_no}::text  = '' then null 
	   			    else #{wkpl_atfl_no}::INTEGER 
   	 		   end
   	 		  ,#{wkpl_main_bsns_cd}
   	 		  ,#{weat_rgn_cd}
   	 		  ,#{usg_yn}
			  ,'N'
			  ,#{username}
			  ,current_timestamp
			  ,#{username}
			  ,current_timestamp
			  ,#{wkpl_img_atfl_no}
	     where not exists (select * from upsert)
    </insert>
    
    <!-- 사업장 선임정보 저장 -->
    <insert id="insertWkplMgntDtlElcInfo" parameterType="sqlMap">
        /* insertWkplMgntDtlElcInfo */
        with upsert as (
		update tb_sh_wkpl_elc
		   set elc_cl_cd    			= #{elc_cl_cd}
		      ,elc_cl_oth_txt    			= #{elc_cl_oth_txt}
		      ,elc_dtl_cl_cd    		= #{elc_dtl_cl_cd}
		      ,ag_yn						= #{ag_yn}
		      ,bsns_agen_orga_nm			= #{bsns_agen_orga_nm}
		      ,bsns_agen_cont_rnew_dt		= #{bsns_agen_cont_rnew_dt}
		      ,elc_rspn_usr_id    			= #{elc_rspn_usr_id}
		      ,elc_pric_nm    				= #{elc_pric_nm}
		      ,elc_pric_dept_nm    			= #{elc_pric_dept_nm}
		      ,elc_pric_pstn_nm    			= #{elc_pric_pstn_nm}
		      ,ctsv_yrs						= case when #{ctsv_yrs}::text  = ''
		      									   then null 
		      								       else #{ctsv_yrs}::INTEGER
		      								   end
		      ,ctsv_mths					= case when #{ctsv_mths}::text  = ''
		      									   then null 
		      								       else #{ctsv_mths}::INTEGER
		      								   end
		      ,wkpl_elc_dt            		= #{wkpl_elc_dt}
		      ,elc_crr_yrs					= case when #{elc_crr_yrs}::text  = ''
		      									   then null 
		      								       else #{elc_crr_yrs}::INTEGER
		      								   end
		      ,elc_crr_mths					= case when #{elc_crr_mths}::text  = ''
		      									   then null 
		      								       else #{elc_crr_mths}::INTEGER
		      								   end
		      ,elc_pric_tel_no    			= #{elc_pric_tel_no}
		      ,elc_pric_email    			= #{elc_pric_email}
		      ,crtf_nm    					= #{crtf_nm}
		      ,mand_tlgl_trn_yn    			= #{mand_tlgl_trn_yn}
		      ,fst_trn_fcst_dt    			= #{fst_trn_fcst_dt}
		      ,rglr_trn_fcst_dt    			= #{rglr_trn_fcst_dt}
		      ,elc_trn_cyc_cd    		= #{elc_trn_cyc_cd}
		      ,trn_expr_dt					= #{trn_expr_dt}
		      ,elc_infr_atfl_no	= case when #{elc_infr_atfl_no}::text  = '' then null 
								   			   else #{elc_infr_atfl_no}::INTEGER 
						    	 		   end
		      ,upt_usr_id       				= #{username}
		      ,upt_dt            			= current_timestamp
		      ,trn_fcst_cert_reg_yn 		= 'N'
		 where wkpl_id = #{wkpl_id} 
		   and elc_reg_sn = #{elc_reg_sn}::numeric RETURNING *
		)
		insert into tb_sh_wkpl_elc (
			   wkpl_id
			  ,elc_reg_sn
			  ,elc_cl_cd
			  ,elc_cl_oth_txt
			  ,elc_dtl_cl_cd
			  ,ag_yn
			  ,bsns_agen_orga_nm
			  ,bsns_agen_cont_rnew_dt
			  ,elc_rspn_usr_id
			  ,elc_pric_nm
			  ,elc_pric_dept_nm
			  ,elc_pric_pstn_nm
			  ,ctsv_yrs
			  ,ctsv_mths
			  ,wkpl_elc_dt
			  ,elc_crr_yrs
			  ,elc_crr_mths
			  ,elc_pric_tel_no
			  ,elc_pric_email
			  ,crtf_nm
			  ,mand_tlgl_trn_yn
			  ,fst_trn_fcst_dt
			  ,rglr_trn_fcst_dt
			  ,elc_trn_cyc_cd
			  ,trn_expr_dt
			  ,elc_infr_atfl_no
			  ,crt_usr_id
			  ,crt_dt
			  ,upt_usr_id
			  ,upt_dt
		)
		select #{wkpl_id}
		      ,(select coalesce(max(elc_reg_sn ::integer),0) + 1 as key
		          from tb_sh_wkpl_elc
		         where wkpl_id = #{wkpl_id}
		       )
		      ,#{elc_cl_cd}
		      ,#{elc_cl_oth_txt}
		      ,#{elc_dtl_cl_cd}
		      ,#{ag_yn}
		      ,#{bsns_agen_orga_nm}
		      ,#{bsns_agen_cont_rnew_dt}
		      ,#{elc_rspn_usr_id}
		      ,#{elc_pric_nm}
		      ,#{elc_pric_dept_nm}
		      ,#{elc_pric_pstn_nm}
		      ,case when #{ctsv_yrs}::text  = ''
		      		then null
	   			    else #{ctsv_yrs}::INTEGER
   	 		   end
		      ,case when #{ctsv_mths}::text  = ''
		      		then null
	   			    else #{ctsv_mths}::INTEGER 
   	 		   end
		      ,#{wkpl_elc_dt}
		      ,case when #{elc_crr_yrs}::text  = ''
		      		then null
	   			    else #{elc_crr_yrs}::INTEGER
   	 		   end
		      ,case when #{elc_crr_mths}::text  = ''
		      		then null
	   			    else #{elc_crr_mths}::INTEGER
   	 		   end
		      ,#{elc_pric_tel_no}
		      ,#{elc_pric_email}
		      ,#{crtf_nm}
		      ,#{mand_tlgl_trn_yn}
			  ,#{fst_trn_fcst_dt}
			  ,#{rglr_trn_fcst_dt}
			  ,#{elc_trn_cyc_cd}
			  ,#{trn_expr_dt}
		      ,case when #{elc_infr_atfl_no}::text  = '' then null 
	   			    else #{elc_infr_atfl_no}::INTEGER 
   	 		   end
		      ,#{username}
		      ,current_timestamp
		      ,#{username}
		      ,current_timestamp
	     where not exists (select * from upsert)
    </insert>
    
    <!-- 사업장 협력사 저장 -->
    <insert id="insertWkplMgntDtlSbcnInfo" parameterType="sqlMap">
        /* insertWkplMgntDtlSbcnInfo */
        with upsert as (
		update tb_sh_wkpl_rsdt_sbcn
		   set bspr_no    				= #{bspr_no}
		      ,inai_wkpl_mgnt_no    	= #{inai_wkpl_mgnt_no}
		      ,sbcn_nm                  = #{sbcn_nm}
		      ,sbcn_main_bsns_cd    = #{sbcn_main_bsns_cd}
		      ,sbcn_prsn_cnt            = #{sbcn_prsn_cnt}::numeric
		      ,sbcn_fld_pric_nm         = #{sbcn_fld_pric_nm}
		      ,sbcn_rprv_nm       		= #{sbcn_rprv_nm}
		      ,mgnt_pric_nm             = #{mgnt_pric_nm}
		      ,sft_pric_nm            	= #{sft_pric_nm}
		      ,hyg_pric_nm       		= #{hyg_pric_nm}
		      ,sbcn_rprs_emad           = #{sbcn_rprs_emad}
		      ,wkpl_note_txt			= #{wkpl_note_txt}
		      ,upt_usr_id       			= #{username}
		      ,upt_dt            		= current_timestamp
		 where wkpl_id = #{wkpl_id} 
		   and sbcn_reg_sn = #{sbcn_reg_sn}::numeric RETURNING *
		)
		insert into tb_sh_wkpl_rsdt_sbcn (
			   wkpl_id
			  ,sbcn_reg_sn
			  ,sbcn_nm
			  ,bspr_no
			  ,inai_wkpl_mgnt_no
			  ,sbcn_main_bsns_cd
			  ,sbcn_prsn_cnt
			  ,sbcn_fld_pric_nm
			  ,sbcn_rprv_nm
			  ,mgnt_pric_nm
			  ,sft_pric_nm
			  ,hyg_pric_nm
			  ,sbcn_rprs_emad
			  ,wkpl_note_txt
			  ,crt_usr_id
			  ,crt_dt
			  ,upt_usr_id
			  ,upt_dt
		)
		select #{wkpl_id}
		      ,(select coalesce(max(sbcn_reg_sn ::integer),0) + 1 as key
		          from tb_sh_wkpl_rsdt_sbcn
		         where wkpl_id = #{wkpl_id}
		       )
		      ,#{sbcn_nm}
		      ,#{bspr_no}
		      ,#{inai_wkpl_mgnt_no}
		      ,#{sbcn_main_bsns_cd}
		      ,#{sbcn_prsn_cnt}::numeric
		      ,#{sbcn_fld_pric_nm}
		      ,#{sbcn_rprv_nm}
		      ,#{mgnt_pric_nm}
		      ,#{sft_pric_nm}
		      ,#{hyg_pric_nm}
		      ,#{sbcn_rprs_emad}
		      ,#{wkpl_note_txt}
		      ,#{username}
		      ,current_timestamp
		      ,#{username}
		      ,current_timestamp
	     where not exists (select * from upsert)
    </insert>
    
    <!-- 사업장 인증정보 저장 -->
    <insert id="insertWkplMgntDtlApalInfo" parameterType="sqlMap">
        /* insertWkplMgntDtlApalInfo */
        with upsert as (
		update tb_sh_wkpl_apal_atht
		   set apal_atht_cl_cd    	= #{apal_atht_cl_cd}
		      ,apal_atht_dt    			= #{apal_atht_dt}
		      ,apal_atht_grd_cd    	= #{apal_atht_grd_cd}
		      ,apal_re_atht_dt          = #{apal_re_atht_dt}
		      ,apal_atht_atfl_no	= case when #{apal_atht_atfl_no}::text  = '' then null 
								   			   else #{apal_atht_atfl_no}::INTEGER 
						    	 		   end
		      ,upt_usr_id       			= #{username}
		      ,upt_dt            		= current_timestamp
		 where wkpl_id = #{wkpl_id} 
		   and apal_atht_reg_sn = #{apal_atht_reg_sn}::numeric RETURNING *
		)
		insert into tb_sh_wkpl_apal_atht (
			   wkpl_id
			  ,apal_atht_reg_sn
			  ,apal_atht_cl_cd
			  ,apal_atht_dt
			  ,apal_atht_grd_cd
			  ,apal_re_atht_dt
			  ,apal_atht_atfl_no
			  ,crt_usr_id
			  ,crt_dt
			  ,upt_usr_id
			  ,upt_dt
		)
		select #{wkpl_id}
		      ,(select coalesce(max(apal_atht_reg_sn ::integer),0) + 1 as key
		          from tb_sh_wkpl_apal_atht
		         where wkpl_id = #{wkpl_id}
		       )
		      ,#{apal_atht_cl_cd}
		      ,#{apal_atht_dt}
		      ,#{apal_atht_grd_cd}
		      ,#{apal_re_atht_dt}
		      ,case when #{apal_atht_atfl_no}::text  = '' then null 
	   			    else #{apal_atht_atfl_no}::INTEGER 
   	 		   end
		      ,#{username}
		      ,current_timestamp
		      ,#{username}
		      ,current_timestamp
	     where not exists (select * from upsert)
    </insert>
    
    <!-- 사업장 선임교육 이력 저장 -->
    <insert id="insertWkplElcTrn" parameterType="sqlMap">
        /* insertWkplElcTrn */
        insert into tb_sh_elc_trn_fcst_hist 
        	 ( elc_rspn_usr_id
              ,elc_cl_cd 
              ,trn_fcst_sn
              ,trn_fcst_dt
              ,trn_fcst_atfl_no
              ,crt_usr_id
              ,crt_dt
              ,upt_usr_id
              ,upt_dt
             ) values (
               #{elc_rspn_usr_id}
              ,#{elc_cl_cd}
              ,(select coalesce(max(z.trn_fcst_sn) + 1, 1) 
                  from tb_sh_elc_trn_fcst_hist z
                 where elc_rspn_usr_id = #{elc_rspn_usr_id}
                   and elc_cl_cd = #{elc_cl_cd})
              ,to_char(now(), 'YYYYMMDD')
              ,#{trn_fcst_atfl_no}::INTEGER 
              ,#{SESS_USR_ID}
              ,now()
              ,#{SESS_USR_ID}
              ,now()
             )
    </insert>
    
    <!-- 사업장 위치정보 저장 -->
    <insert id="insertWkplMgntDtlRgnInfo" parameterType="sqlMap">
        /* insertWkplMgntDtlRgnInfo */
        with upsert as (
		update tb_sh_wkpl_sts_loc
		   set wkpl_loc_xcrd    	= #{wkpl_loc_xcrd}
		      ,wkpl_loc_ycrd    	= #{wkpl_loc_ycrd}
		      ,upt_usr_id       		= #{username}
		      ,upt_dt            	= current_timestamp
		 where wkpl_id = #{wkpl_id} 
		   and wkpl_loc_id = #{wkpl_loc_id} RETURNING *
		)
		insert into tb_sh_wkpl_sts_loc (
			   wkpl_id
			  ,wkpl_loc_id
			  ,wkpl_loc_xcrd
			  ,wkpl_loc_ycrd
			  ,crt_usr_id
			  ,crt_dt
			  ,upt_usr_id
			  ,upt_dt
		)
		select #{wkpl_id}
		      ,#{wkpl_loc_id}
		      ,#{wkpl_loc_xcrd}
		      ,#{wkpl_loc_ycrd}
		      ,#{username}
		      ,current_timestamp
		      ,#{username}
		      ,current_timestamp
	     where not exists (select * from upsert)
    </insert>
    
    <!-- 사업장 선임정보 삭제 -->
    <delete id="deleteWkplMgntDtlElcInfo" parameterType="sqlMap">
        /* deleteWkplMgntDtlElcInfo */
        delete 
          from tb_sh_wkpl_elc
		 where wkpl_id = #{wkpl_id}
		   and elc_reg_sn = #{elc_reg_sn}::numeric
    </delete>
    
    <!-- 사업장 협력사 삭제 -->
    <delete id="deleteWkplMgntDtlSbcnInfo" parameterType="sqlMap">
        /* deleteWkplMgntDtlSbcnInfo */
        delete 
          from tb_sh_wkpl_rsdt_sbcn
		 where wkpl_id = #{wkpl_id}
		   and sbcn_reg_sn = #{sbcn_reg_sn}::numeric
		   and sbcn_nm = #{sbcn_nm}
    </delete>
    
    <!-- 사업장 인증정보 삭제 -->
    <delete id="deleteWkplMgntDtlApalInfo" parameterType="sqlMap">
        /* deleteWkplMgntDtlApalInfo */
        delete 
          from tb_sh_wkpl_apal_atht
		 where wkpl_id = #{wkpl_id}
		   and apal_atht_reg_sn = #{apal_atht_reg_sn}::numeric
    </delete>
    
    <!-- 사업장 선임교육 이력 삭제 -->
    <delete id="deleteWkplElcTrn" parameterType="sqlMap">
        /* deleteWkplElcTrn */
        delete 
          from tb_sh_elc_trn_fcst_hist 
		 where elc_rspn_usr_id = #{elc_rspn_usr_id}
     	   and elc_cl_cd = #{elc_cl_cd}
		   and trn_fcst_dt = to_char(now(), 'YYYYMMDD')
    </delete>
    
    <!-- 사업장 위치정보 삭제 -->
    <delete id="deleteWkplMgntDtlRgnInfo" parameterType="sqlMap">
        /* deleteWkplMgntDtlRgnInfo */
        delete 
          from tb_sh_wkpl_sts_loc
		 where wkpl_id = #{wkpl_id}
		   and wkpl_loc_id = #{wkpl_loc_id}
    </delete>
    
    <update id="updateCdMlangWkpl" parameterType="sqlMap">
        /* updateCdMlangWkpl */
        update tb_co_mlang set
             mlang_cntn = trim(BOTH FROM #{cd_nm}::text)
            ,usg_yn = 'Y'
            ,del_yn = 'N'
        	,upt_usr_id = #{username}
        	,upt_dt = to_char(now(), 'YYYYMMDDHH24MISS')
        where mlang_no = #{mlang_no}
          and lang_cd = #{lang_cd}
    </update>
	
    <!-- 사업장 교육이수증 등록여부 업데이트 -->
    <update id="updateWkplElcTrn" parameterType="sqlMap">
        /* updateWkplElcTrn */
        update tb_sh_wkpl_elc
		   set trn_fcst_cert_reg_yn = case when replace(trn_expr_dt,'-','') <![CDATA[<]]> to_char(now(), 'YYYYMMDD') then 'N'
		   								   when replace(trn_expr_dt,'-','') <![CDATA[>=]]> to_char(now(), 'YYYYMMDD') then 'Y'
		   							   end
        	  ,upt_usr_id = #{SESS_USR_ID}	
        	  ,upt_dt = now()
		 where wkpl_id = #{wkpl_id}
		   and elc_cl_cd = #{elc_cl_cd}
		   and elc_rspn_usr_id  = #{elc_rspn_usr_id}
    </update>
    
    <!-- 사업장 교육이수증 삭제 후 미등록 상태로 업데이트 -->
    <update id="updateWkplElcTrn2" parameterType="sqlMap">
        /* updateWkplElcTrn2 */
        update tb_sh_wkpl_elc
		   set trn_fcst_cert_reg_yn = 'N'
        	  ,upt_usr_id = #{SESS_USR_ID}	
        	  ,upt_dt = now()
		 where wkpl_id = #{wkpl_id}
		   and elc_cl_cd = #{elc_cl_cd}
		   and elc_rspn_usr_id  = #{elc_rspn_usr_id}
    </update>
    
    <!-- 사업장 선임교육 이력 삭제 -->
    <delete id="deleteWkplElcTrn2" parameterType="sqlMap">
        /* deleteWkplElcTrn2 */
        delete 
          from tb_sh_elc_trn_fcst_hist 
		 where elc_rspn_usr_id = #{elc_rspn_usr_id}
     	   and elc_cl_cd = #{elc_cl_cd}
		   and trn_fcst_sn = #{trn_fcst_sn}::numeric
    </delete>
    
    <!-- 사업장 그룹정보 조회 -->
    <select id="selectWkplMgntDtlCatInfo" parameterType="sqlMap" resultType="string" useCache="false">
        /* selectWkplMgntDtlCatInfo */
		select wkpl_cat_cd	
		from tb_sh_wkpl_cat_mapg
	   where 1=1
		 and wkpl_cat_cd = #{wkpl_cat_cd}
		 and wkpl_id = #{wkpl_id}
    </select>
    
    <!-- 사업장 그룹정보 수정 -->
    <update id="updateWkplElcAppr" parameterType="sqlMap">
        /* updateWkplElcAppr */
        update tb_sh_wkpl_elc
		   set aprv_no = #{aprv_no}
        	  ,upt_usr_id = #{SESS_USR_ID}	
        	  ,upt_dt = now()
	   where wkpl_id = #{wkpl_id}
		 and elc_reg_sn = #{elc_reg_sn}::Numeric
    </update>
    
    <!-- 사업장 그룹정보 수정 -->
    <update id="updateWkplMgntDtlCatInfo" parameterType="sqlMap">
        /* updateWkplMgntDtlCatInfo */
        update tb_sh_wkpl_cat_mapg
		   set del_yn = #{del_yn}
        	  ,upt_usr_id = #{SESS_USR_ID}	
        	  ,upt_dt = now()
	   where wkpl_cat_cd = #{wkpl_cat_cd}
		 and wkpl_id = #{wkpl_id}
    </update>

    <!-- 사업장 그룹정보 삭제 -->
    <delete id="deleteWkplMgntDtlCatInfo" parameterType="sqlMap">
        /* deleteWkplMgntDtlCatInfo */
        delete 
          from tb_sh_wkpl_cat_mapg
		 where wkpl_cat_cd = #{wkpl_cat_cd}
		   and wkpl_id = #{wkpl_id}
    </delete>
    <!-- 사업장 그룹정보 저장 -->
    <insert id="insertWkplMgntDtlCatInfo" parameterType="sqlMap">
        /* insertWkplMgntDtlCatInfo */
        insert into tb_sh_wkpl_cat_mapg (
	        wkpl_cat_cd
	        ,wkpl_id
	        ,crt_usr_id
	        ,upt_usr_id
        ) values (
        	#{wkpl_cat_cd}
        	,#{wkpl_id}
        	,#{SESS_USR_ID}
        	,#{SESS_USR_ID}
        )
    </insert>
    
    <!-- 사업장 이미지 조회 -->
    <select id="selectWkplImg" parameterType="sqlMap" resultType="string" useCache="false">
        /* selectWkplImg */
		select
			wkpl_img_atfl_no	
		from
			tb_sh_wkpl
	   where
	   		wkpl_id = #{wkpl_id}
    </select>
</mapper>